<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Tr·∫ßn Kim B·∫£o Ng·ªçc - The Eternal Muse</title>

    <!-- FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Alex+Brush&family=Cinzel:wght@400;600;700&family=Montserrat:wght@300;400;500;600&family=Pinyon+Script&family=Playfair+Display:ital,wght@0,400;0,600;1,400&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,600&display=swap"
      rel="stylesheet"
    />

    <!-- LIBRARIES -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
      :root {
        /* PALETTE */
        --bg-deep: #2d1b26;
        --bg-paper: #fffcf5;
        --primary-pink: #ffc2d1;
        --deep-rose: #b76e79;
        --hot-pink: #e84393;
        --gold: #d4af37;
        --text-light: #fff5f8;
        --text-dark: #5e4b52;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background-color: var(--bg-deep);
        color: var(--text-light);
        font-family: "Montserrat", sans-serif;
        overflow-x: hidden;
        user-select: none;
        -webkit-user-select: none;
      }

      /* --- CINEMATIC GRAIN --- */
      body::after {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.04'/%3E%3C/svg%3E");
        pointer-events: none;
        z-index: 9990;
        mix-blend-mode: overlay;
      }

      /* TYPOGRAPHY */
      .serif {
        font-family: "Playfair Display", serif;
      }
      .cinzel {
        font-family: "Cinzel", serif;
        letter-spacing: 2px;
      }
      .royal {
        font-family: "Pinyon Script", cursive;
      }
      .script {
        font-family: "Alex Brush", cursive;
      }
      .reading {
        font-family: "Cormorant Garamond", serif;
      }

      .hidden {
        opacity: 0;
        pointer-events: none;
      }
      canvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1;
      }

      /* GLOBAL PARTICLES */
      #global-particles {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9980;
      }

      .text-safe {
        width: 90%;
        max-width: 600px;
        text-align: center;
        position: relative;
        z-index: 10;
        padding: 0 15px;
        word-wrap: break-word;
      }

      /* --- LOADER --- */
      #loader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        background: radial-gradient(circle at center, #5e2a40 0%, #1a0b10 100%);
        z-index: 9999;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        transition: opacity 1.5s ease-in-out;
      }
      .loader-ring {
        width: 80px;
        height: 80px;
        border: 3px solid transparent;
        border-top-color: var(--primary-pink);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        box-shadow: 0 0 20px rgba(255, 183, 197, 0.3);
      }
      .start-btn {
        margin-top: 30px;
        padding: 15px 40px;
        background: linear-gradient(45deg, #d4af37, #f1c40f);
        color: #fff;
        border: none;
        border-radius: 2px;
        font-family: "Cinzel", serif;
        font-weight: 700;
        font-size: 0.9rem;
        cursor: pointer;
        transition: 0.5s;
        letter-spacing: 4px;
        box-shadow: 0 5px 20px rgba(212, 175, 55, 0.4);
      }
      .start-btn:active {
        transform: scale(0.95);
      }

      /* --- SECTIONS --- */
      .section {
        position: relative;
        width: 100%;
        min-height: 100vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: 40px 0;
      }

      /* PARTICLES */
      .love-dust {
        position: absolute;
        background: radial-gradient(circle, #fff, transparent);
        border-radius: 50%;
        opacity: 0.8;
        pointer-events: none;
        animation: floatDust linear infinite;
        filter: drop-shadow(0 0 5px #fff);
      }
      .heart-dust {
        position: absolute;
        color: var(--primary-pink);
        font-size: 12px;
        opacity: 0.6;
        pointer-events: none;
        animation: floatDust linear infinite;
        text-shadow: 0 0 8px var(--hot-pink);
      }

      /* CHAP 1: N√ÄNG TH∆† */
      #chap-muse {
        background: linear-gradient(180deg, #fff5f8 0%, #ffe6ea 100%);
        color: var(--text-dark);
      }
      .muse-frame {
        position: absolute;
        padding: 12px;
        background: #fff;
        box-shadow: 0 20px 50px rgba(183, 110, 121, 0.2);
        opacity: 0;
        border-radius: 4px;
      }
      .p1 {
        width: 70%;
        top: 10%;
        left: 0%;
        z-index: 2;
        transform: rotate(-5deg);
      }
      .p2 {
        width: 60%;
        bottom: 10%;
        right: 0%;
        z-index: 3;
        transform: rotate(5deg);
      }
      .p3 {
        width: 50%;
        top: 40%;
        left: 25%;
        z-index: 1;
        filter: blur(1px) contrast(1.1);
        opacity: 0.8;
      }
      .muse-img {
        width: 100%;
        display: block;
        border: 1px solid #eee;
      }

      .title-box {
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.8);
        padding: 30px 20px;
        border-radius: 50% 50% 0 0 / 20px 20px 0 0;
        box-shadow: 0 20px 60px rgba(232, 67, 147, 0.15);
        z-index: 10;
        margin-bottom: 20px;
        text-align: center;
      }
      .title-box h1 {
        font-size: 3.5rem;
        color: var(--deep-rose);
        margin: 0;
        line-height: 0.9;
      }
      .title-box p {
        font-size: 0.8rem;
        color: #8e5a5a;
        margin-top: 15px;
        letter-spacing: 5px;
        font-weight: 600;
        text-transform: uppercase;
      }

      /* CHAP 2: ZEN */
      #chap-zen {
        background: radial-gradient(circle at center, #6d214f, #2d1b26);
        color: #fff;
      }
      .zen-gateway {
        position: relative;
        width: 280px;
        height: 420px;
        border: 1px solid rgba(255, 255, 255, 0.4);
        border-radius: 200px 200px 0 0;
        overflow: hidden;
        z-index: 5;
        box-shadow: 0 0 100px rgba(255, 183, 197, 0.3);
        opacity: 0;
        background: #000;
      }
      .zen-photo {
        width: 100%;
        height: 100%;
        object-fit: cover;
        opacity: 0.95;
      }
      .zen-overlay {
        position: absolute;
        bottom: 0;
        width: 100%;
        background: linear-gradient(to top, #2d1b26 20%, transparent);
        padding: 80px 20px 40px;
        text-align: center;
      }
      .zen-bg-layer {
        position: absolute;
        width: 100%;
        height: 100%;
        object-fit: cover;
        opacity: 0.1;
        filter: grayscale(100%) hue-rotate(290deg);
        z-index: 0;
        transform: scale(1.1);
      }

      /* CHAP 3: DESTINY */
      #chap-destiny {
        background:
          radial-gradient(
            circle at 20% 30%,
            rgba(232, 67, 147, 0.4),
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 70%,
            rgba(109, 33, 79, 0.6),
            transparent 50%
          ),
          #1a0b10;
      }
      .heart-core {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 300px;
        height: 300px;
        background: radial-gradient(
          circle,
          rgba(255, 194, 209, 0.3) 0%,
          transparent 70%
        );
        animation: heartbeat 2s infinite;
        z-index: 0;
        border-radius: 50%;
        filter: blur(20px);
      }
      .thread-text h2 {
        font-family: "Pinyon Script", cursive;
        color: var(--primary-pink);
        text-shadow: 0 0 30px var(--hot-pink);
        font-size: 3.5rem;
        margin-bottom: 10px;
      }
      .cinzel-big {
        font-size: 5rem;
        color: #fff;
        text-shadow: 0 0 30px var(--hot-pink);
        line-height: 1;
        font-weight: 700;
      }
      .destiny-quote {
        font-family: "Cormorant Garamond", serif;
        font-size: 1.4rem;
        color: #ffeef2;
        font-style: italic;
        margin-top: 30px;
        line-height: 1.6;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
        max-width: 85%;
        margin-left: auto;
        margin-right: auto;
      }

      /* CHAP 4: LETTER */
      #chap-letter {
        background:
          url("https://www.transparenttextures.com/patterns/stardust.png"),
          linear-gradient(to bottom, #4a2c40, #2d1b26);
      }
      .scroll-paper {
        background: rgba(255, 255, 255, 0.05); /* Glass */
        backdrop-filter: blur(25px) saturate(150%);
        width: 90%;
        max-height: 70vh;
        overflow-y: auto;
        padding: 40px 30px;
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-top: 1px solid rgba(255, 255, 255, 0.5);
        box-shadow: 0 20px 80px rgba(0, 0, 0, 0.6);

        font-family: "Pinyon Script", cursive;
        font-size: 1.8rem;
        color: #ffc2d1;
        line-height: 1.6;
        text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
      }
      .scroll-paper::-webkit-scrollbar {
        width: 3px;
      }
      .scroll-paper::-webkit-scrollbar-thumb {
        background: var(--gold);
      }

      /* CHAP 5: PRAYER (FIXED RESPONSIVENESS) */
      #chap-prayer {
        background: radial-gradient(circle, #b33771 0%, #2c1b2e 100%);
      }
      .hold-area {
        position: relative;
        width: 80vw;
        max-width: 300px;
        height: 105vw;
        max-height: 400px;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .prayer-frame {
        width: 100%;
        height: 100%;
        border-radius: 50% 50% 10% 10% / 40% 40% 5% 5%; /* H√¨nh v√≤m responsive */
        overflow: hidden;
        border: 3px solid rgba(255, 255, 255, 0.3);
        position: relative;
        z-index: 5;
        transition: all 0.3s ease;
        cursor: pointer;
        box-shadow: 0 0 40px rgba(251, 197, 49, 0.3);
      }
      .prayer-photo {
        width: 100%;
        height: 100%;
        object-fit: cover;
        filter: sepia(0.3) contrast(1.1);
        transition: 0.5s;
      }

      .energy-ring {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 110%;
        height: 110%; /* L·ªõn h∆°n khung m·ªôt ch√∫t */
        border-radius: 50% 50% 10% 10% / 40% 40% 5% 5%;
        border: 2px solid var(--gold);
        opacity: 0;
        transition: 0.2s;
        box-shadow: 0 0 30px var(--gold);
        z-index: 1;
      }

      .hold-hint {
        position: absolute;
        bottom: -50px;
        width: 100%;
        text-align: center;
        color: var(--gold);
        font-size: 0.9rem;
        letter-spacing: 3px;
        animation: blink 2s infinite;
        text-transform: uppercase;
        text-shadow: 0 0 10px rgba(251, 197, 49, 0.5);
      }
      .prayer-content {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 20;
        opacity: 0;
        pointer-events: none;
        background: rgba(44, 27, 46, 0.9);
        padding: 25px;
        text-align: center;
      }
      .prayer-verse {
        font-family: "Pinyon Script", cursive;
        font-size: 1.8rem;
        color: #fff;
        line-height: 1.4;
        text-shadow: 0 0 10px var(--gold);
      }

      /* --- CHAP 6: THE VOW (FIXED UI BUG) --- */
      #chap-contract {
        background: linear-gradient(to top, #1a0b14, #2c1b2e);
        border-top: 3px solid var(--hot-pink);
      }
      .vow-certificate {
        width: 90%;
        max-width: 500px;
        background: var(--bg-paper);
        border: 2px solid var(--gold);
        outline: 4px double var(--gold);
        outline-offset: 5px;
        padding: 30px 20px 50px 20px; /* Th√™m padding d∆∞·ªõi ƒë·ªÉ ch·ª©a con d·∫•u */
        border-radius: 4px;
        position: relative;
        color: #4a2c2c;
        box-shadow: 0 0 100px rgba(255, 215, 0, 0.2);
        text-align: center;
        background-image: radial-gradient(#d4af37 0.5px, transparent 0.5px);
        background-size: 15px 15px;
      }
      /* H·ªça ti·∫øt g√≥c */
      .vow-certificate::before,
      .vow-certificate::after {
        content: "‚ú¶";
        position: absolute;
        color: var(--gold);
        font-size: 1.5rem;
      }
      .vow-certificate::before {
        top: 10px;
        left: 10px;
      }
      .vow-certificate::after {
        bottom: 10px;
        right: 10px;
      }

      .vow-header {
        font-family: "Cinzel", serif;
        font-size: 1.6rem;
        color: #d4af37;
        margin-bottom: 15px;
        font-weight: 700;
        text-shadow: 1px 1px 0px #fff;
        border-bottom: 1px solid #d4af37;
        padding-bottom: 10px;
        display: inline-block;
      }
      .vow-names {
        font-family: "Pinyon Script", cursive;
        font-size: 2.5rem;
        color: #b76e79;
        margin: 15px 0;
        line-height: 1.2;
      }
      .vow-body {
        font-family: "Montserrat", sans-serif;
        font-size: 0.85rem;
        line-height: 1.7;
        margin-bottom: 20px;
        font-weight: 500;
      }
      .wedding-rings {
        font-size: 2.5rem;
        margin: 10px 0;
        color: #d4af37;
        animation: pulse 3s infinite;
      }

      #signature-pad {
        width: 100%;
        height: 100px;
        margin: 0 auto;
        border-bottom: 2px solid #4a2c2c;
        background: transparent;
        touch-action: none;
      }
      .sign-placeholder {
        font-size: 0.7rem;
        color: #888;
        margin-bottom: 5px;
        text-transform: uppercase;
        letter-spacing: 2px;
      }
      .sign-btn {
        margin-top: 15px;
        padding: 12px 35px;
        background: linear-gradient(to right, #d4af37, #f1c40f);
        color: #fff;
        border: none;
        font-family: "Cinzel", serif;
        font-weight: bold;
        cursor: pointer;
        text-transform: uppercase;
        letter-spacing: 2px;
        box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
        border-radius: 50px;
      }

      /* FIX BUG: Con d·∫•u n·∫±m g·ªçn g√≥c ph·∫£i d∆∞·ªõi, kh√¥ng ƒë√® ch·ªØ */
      .wax-seal {
        position: absolute;
        bottom: 20px;
        right: 20px;
        width: 90px;
        height: 90px;
        background: radial-gradient(circle at 30% 30%, #ff4d4d, #990000);
        border-radius: 50%;
        box-shadow:
          3px 3px 10px rgba(0, 0, 0, 0.4),
          inset 0 0 20px rgba(0, 0, 0, 0.2);
        border: 2px dashed rgba(255, 255, 255, 0.4);
        display: flex;
        justify-content: center;
        align-items: center;
        color: rgba(255, 255, 255, 0.9);
        font-weight: bold;
        font-family: "Cinzel", serif;
        font-size: 0.9rem;
        opacity: 0;
        transform: scale(1.5) rotate(-15deg);
        pointer-events: none;
        z-index: 20;
        text-shadow: 0 1px 2px #000;
      }

      /* ANIMATIONS */
      @keyframes heartbeat {
        0% {
          transform: translate(-50%, -50%) scale(1);
          opacity: 0.5;
        }
        50% {
          transform: translate(-50%, -50%) scale(1.2);
          opacity: 0.8;
        }
        100% {
          transform: translate(-50%, -50%) scale(1);
          opacity: 0.5;
        }
      }
      @keyframes floatDust {
        0% {
          transform: translateY(0) translateX(0) rotate(0deg);
          opacity: 0;
        }
        50% {
          opacity: 1;
        }
        100% {
          transform: translateY(-100vh) translateX(50px) rotate(360deg);
          opacity: 0;
        }
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      @keyframes blink {
        0%,
        100% {
          opacity: 0.5;
        }
        50% {
          opacity: 1;
        }
      }
      @keyframes pulse {
        0% {
          opacity: 0.7;
          transform: scale(0.95);
        }
        50% {
          opacity: 1;
          transform: scale(1.05);
        }
        100% {
          opacity: 0.7;
          transform: scale(0.95);
        }
      }
      /* --- STYLE CHO SECTION 2 M·ªöI (DUAL VIBE) --- */
        #chap-zen {
            position: relative;
            background: #fff0f5; /* M·∫∑c ƒë·ªãnh h·ªìng nh·∫°t */
            transition: background 0.5s ease;
        }
        
        .s2-bg-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 100%);
            z-index: 0; opacity: 0.5;
        }

        .s2-card-container {
            display: flex; justify-content: center; align-items: center;
            gap: 20px; z-index: 10; width: 100%;
            perspective: 1000px; /* T·∫°o chi·ªÅu s√¢u 3D */
        }

        .s2-card {
            width: 42vw; height: 60vw; max-width: 200px; max-height: 300px;
            cursor: pointer; position: relative;
            transform-style: preserve-3d;
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .s2-card.left { transform: rotateY(15deg) translateZ(0); }
        .s2-card.right { transform: rotateY(-15deg) translateZ(0); }
        
        /* Hi·ªáu ·ª©ng khi Active */
        .s2-card.active { 
            transform: rotateY(0) scale(1.1) translateZ(50px) !important; 
            z-index: 20;
        }
        .s2-card.inactive {
            transform: scale(0.9); opacity: 0.6; filter: blur(2px);
        }

        .s2-inner {
            width: 100%; height: 100%;
            border-radius: 15px; overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border: 4px solid #fff;
            position: relative;
        }

        .s2-img {
            width: 100%; height: 100%; object-fit: cover;
            transition: transform 0.5s;
        }

        .s2-label {
            position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);
            background: rgba(255,255,255,0.8);
            padding: 5px 15px; border-radius: 20px;
            font-family: 'Montserrat', sans-serif; font-weight: 600;
            font-size: 0.8rem; color: #d66d75;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .s2-message {
            margin-top: 30px; font-style: italic; color: #8854d0;
            opacity: 0; transform: translateY(20px); transition: 0.5s;
        }
    </style>
  </head>
  <body>
    <!-- AUDIO PLAYER -->
    <div id="yt-player" data-video-id="3onAOL9dY1o"></div>

    <!-- GLOBAL PARTICLES (FIXED & FULL SCREEN) -->
    <div id="global-particles"></div>

    <!-- 0. LOADER -->
    <div id="loader">
      <div class="loader-ring"></div>
      <div
        class="serif"
        style="
          color: var(--primary-pink);
          margin-top: 20px;
          font-size: 1.8rem;
          text-shadow: 0 0 20px var(--hot-pink);
        "
      >
        Tr·∫ßn Kim B·∫£o Ng·ªçc
      </div>
      <div
        class="cinzel"
        style="
          color: var(--gold);
          font-size: 0.8rem;
          margin-top: 10px;
          letter-spacing: 5px;
        "
      >
        THE ETERNAL MUSE
      </div>
      <button class="start-btn" onclick="enterUniverse()">K·∫æT N·ªêI</button>
    </div>

    <!-- MAIN APP -->
    <div id="main-app" class="hidden">
      <!-- 1. N√ÄNG TH∆† -->
      <div class="section" id="chap-muse">
        <canvas id="canvas-petals"></canvas>
        <div class="text-safe title-box">
          <h1 class="serif">Tu·ªïi 18</h1>
          <p class="cinzel" style="color: #a45056; font-size: 0.8rem">
            NG·ªåT NG√ÄO NH∆Ø √ÅNH D∆Ø∆†NG
          </p>
        </div>
        <div class="muse-frame p1">
          <img
            src=assets/z7505800560704_28f8f1a9ad403aab96492601257acf32.jpg
            class="muse-img"
          />
        </div>
        <div class="muse-frame p2">
          <img
            src=assets/z7505800559378_879107eb21e0e155380a06b7829f59af.jpg
            class="muse-img"
          />
        </div>
        <div class="muse-frame p3">
          <img
            src=assets/z7505800560882_47b88f285e91e5263a0466b5c4140585.jpg
            class="muse-img"
          />
        </div>
      </div>

      <!-- 2. KHU V∆Ø·ªúN C·∫¢M X√öC (NEW CONCEPT: DUAL VIBE) -->
        <div class="section" id="chap-zen">
            <!-- Background chuy·ªÉn m√†u ƒë·ªông -->
            <div class="s2-bg-layer" id="s2-bg"></div>
            
            <div class="text-safe title-box" style="margin-bottom: 30px;">
                <h1 class="serif" style="color: #e84393; font-size: 2.5rem;">Th·∫ø Gi·ªõi C·ªßa Em</h1>
                <p class="cinzel" style="color: #a45056; font-size: 0.7rem; margin-top: 5px;">CH·∫†M V√ÄO ƒê·ªÇ KH√ÅM PH√Å V·∫∫ ƒê·∫∏P</p>
            </div>

            <div class="s2-card-container">
                <!-- CARD 1: SWEET (H·ªíNG) -->
                <div class="s2-card left" onclick="activeVibe('pink')">
                    <div class="s2-inner">
                        <img src="assets/75244cb0-1374-47a5-a49e-5219b54b0643.jpg" class="s2-img">
                        <div class="s2-label">Ng·ªçt Ng√†o</div>
                    </div>
                </div>

                <!-- CARD 2: PURE (TR·∫ÆNG) -->
                <div class="s2-card right" onclick="activeVibe('white')">
                    <div class="s2-inner">
                        <img src="assets/a4b129eb-fa83-4cd2-b3f5-e145e964938b.jpg" class="s2-img">
                        <div class="s2-label">Tinh Kh√¥i</div>
                    </div>
                </div>
            </div>

            <div class="s2-message text-safe" id="s2-msg">
                "D√π l√† c√¥ng ch√∫a ƒë·ªùi th∆∞·ªùng hay n√†ng th∆° tho√°t t·ª•c,<br>em ƒë·ªÅu l√† ki·ªát t√°c."
            </div>
        </div>

      <!-- 2. C√ïI T·ªäNH -->
      <div class="section" id="chap-zen">
        <div class="zen-gateway">
          <img
            src=assets/z7505800568275_c58c5ba702d7f29b6aa8afe8627e1fba.jpg
            class="zen-photo"
          />
          <div class="zen-overlay">
            <h2
              class="royal"
              style="
                font-size: 3.5rem;
                color: #e0ccff;
                text-shadow: 0 0 20px #8854d0;
              "
            >
              An Y√™n
            </h2>
            <p
              class="reading"
              style="font-size: 1.3rem; color: #f3e5f5; margin-top: 10px"
            >
              "V·∫ª ƒë·∫πp s√¢u s·∫Øc nh·∫•t c·ªßa em n·∫±m ·ªü t√¢m h·ªìn h∆∞·ªõng thi·ªán."
            </p>
          </div>
        </div>
        <img
          src=assets/z7505800561206_f3b5530a7faaa0897d7b0d421ad0a398.jpg
          class="zen-bg-layer"
        />
      </div>

      <!-- 3. ƒê·ªäNH M·ªÜNH -->
      <div class="section" id="chap-destiny">
        <canvas id="canvas-thread"></canvas>
        <div class="heart-core"></div>

        <div class="thread-text text-safe">
          <h2 class="royal" style="font-size: 4rem; margin: 0; color: #ffb7c5">
            Giao Thoa
          </h2>
          <p
            class="cinzel"
            style="font-size: 0.9rem; color: var(--gold); margin-bottom: 20px"
          >
            C·ª¶A HAI LINH H·ªíN
          </p>
          <h1 class="cinzel-big">26/1</h1>
          <p class="destiny-quote">
            "Trong kho·∫£nh kh·∫Øc thi√™ng li√™ng ·∫•y, v≈© tr·ª• ƒë√£ ng·ª´ng quay ƒë·ªÉ ch·ª©ng
            gi√°m cho l·ªùi th·ªÅ th·∫ßm l·∫∑ng:<br />
            <span style="color: var(--primary-pink); font-weight: 700"
              >Em ƒë√£ thu·ªôc v·ªÅ Anh, tr·ªçn v·∫πn v√† duy nh·∫•t.</span
            >"
          </p>
        </div>
      </div>

      <!-- 4. B·ª®C TH∆Ø -->
      <div class="section" id="chap-letter">
        <div class="scroll-paper text-safe" id="letter-content"></div>
      </div>

      <!-- 5. L·ªúI NGUY·ªÜN C·∫¶U (FIXED FRAME) -->
      <div class="section" id="chap-prayer">
        <div class="hold-area" id="hold-target">
          <div class="energy-ring"></div>
          <div class="prayer-frame">
            <img
              src=assets/z7505800560882_47b88f285e91e5263a0466b5c4140585.jpg
              class="prayer-photo"
              id="prayer-img"
            />
            <div class="prayer-content" id="prayer-text">
              <div
                style="
                  font-family: &quot;Cinzel&quot;, serif;
                  color: var(--gold);
                  font-size: 1.2rem;
                  margin-bottom: 20px;
                "
              >
                T√ÇM NGUY·ªÜN
              </div>
              <p class="prayer-verse">
                "Nguy·ªán d√πng c·∫£ sinh m·ªánh n√†y<br />
                ƒë·ªÉ che ch·ªü cho n·ª• c∆∞·ªùi c·ªßa em<br />
                m·ªôt ƒë·ªùi b√¨nh an."
              </p>
            </div>
          </div>
          <div class="hold-hint" id="hold-hint">GI·ªÆ CH·∫∂T ƒê·ªÇ C·∫¶U NGUY·ªÜN</div>
        </div>
      </div>

      <!-- 6. H√îN ∆Ø·ªöC NG√ÇN H√Ä (FIXED SEAL POSITION) -->
      <div class="section" id="chap-contract">
        <div class="vow-certificate">
          <div class="vow-header">H√¥n ∆Ø·ªõc Ng√¢n H√†</div>
          <div class="wedding-rings">üíç</div>
          <div class="vow-body">
            Tr∆∞·ªõc s·ª± ch·ª©ng gi√°m c·ªßa c√°c v√¨ sao v√† ƒë·∫•t tr·ªùi,<br />
            VƒÉn Tr√≠ xin th·ªÅ nguy·ªán s·∫Ω d√πng c·∫£ cu·ªôc ƒë·ªùi n√†y<br />
            ƒë·ªÉ y√™u th∆∞∆°ng, b·∫£o v·ªá v√† x√¢y d·ª±ng m·ªôt t∆∞∆°ng lai r·ª±c r·ª° nh·∫•t<br />
            cho ng∆∞·ªùi v·ª£ ƒë·ªãnh m·ªánh c·ªßa m√¨nh:
          </div>

          <div class="vow-names">Tr·∫ßn Kim B·∫£o Ng·ªçc</div>

          <div class="sign-placeholder">CH·ªÆ K√ù C·ª¶A EM</div>
          <canvas id="signature-pad"></canvas>

          <button class="sign-btn" onclick="submitSign()">
            ƒê·ªíNG √ù L·∫§Y ANH
          </button>

          <!-- Con d·∫•u s√°p ƒë·ªè: ƒê·∫∑t ·ªü g√≥c d∆∞·ªõi c√πng b√™n ph·∫£i, kh√¥ng che ch·ªØ k√Ω -->
          <div class="wax-seal" id="seal">ƒê√É K√ù</div>
        </div>
      </div>
    </div>

    <script>
      // --- AUTO-PLAY MUSIC ---
      var player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player("yt-player", {
          height: "0",
          width: "0",
          videoId: "3onAOL9dY1o",
          playerVars: {
            autoplay: 0,
            controls: 0,
            loop: 1,
            playlist: "3onAOL9dY1o",
          },
          events: { onReady: onPlayerReady },
        });
      }
      function onPlayerReady(event) {
        event.target.setVolume(100);
      }
      var tag = document.createElement("script");
      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName("script")[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      function enterUniverse() {
        if (player && player.playVideo) {
          player.playVideo();
          player.unMute();
        }
        gsap.to("#loader", {
          opacity: 0,
          duration: 1.5,
          onComplete: () => {
            document.getElementById("loader").style.display = "none";
            document.getElementById("main-app").classList.remove("hidden");
            initAnims();
            initThread();
            initHold();
          },
        });
      }

      // --- PARTICLES ---
      function addFullLoveDust() {
        const container = document.getElementById("global-particles");
        const particleCount = 60;
        for (let i = 0; i < particleCount; i++) {
          let d = document.createElement("div");
          d.className = "love-dust";
          d.style.left = Math.random() * 100 + "vw";
          d.style.top = Math.random() * 100 + "vh";
          d.style.width = Math.random() * 3 + 1 + "px";
          d.style.height = d.style.width;
          d.style.animationDuration = Math.random() * 10 + 10 + "s";
          d.style.animationDelay = Math.random() * 5 + "s";
          container.appendChild(d);

          if (i % 3 === 0) {
            let h = document.createElement("div");
            h.className = "heart-dust";
            h.innerHTML = "‚ù§";
            h.style.left = Math.random() * 100 + "vw";
            h.style.top = Math.random() * 100 + "vh";
            h.style.fontSize = Math.random() * 12 + 8 + "px";
            h.style.animationDuration = Math.random() * 15 + 10 + "s";
            h.style.animationDelay = Math.random() * 5 + "s";
            container.appendChild(h);
          }
        }
      }
      addFullLoveDust();

      gsap.registerPlugin(ScrollTrigger);

      function initAnims() {
        gsap.to(".p1", {
          y: -30,
          opacity: 1,
          duration: 1.5,
          scrollTrigger: { trigger: "#chap-muse", start: "top center" },
        });
        gsap.to(".p2", {
          y: -20,
          opacity: 1,
          duration: 1.5,
          delay: 0.2,
          scrollTrigger: { trigger: "#chap-muse", start: "top center" },
        });
        gsap.to(".p3", {
          scale: 1.1,
          opacity: 0.8,
          duration: 2,
          scrollTrigger: { trigger: "#chap-muse", start: "top center" },
        });
        gsap.to(".zen-gateway", {
          opacity: 1,
          y: -20,
          duration: 2,
          scrollTrigger: { trigger: "#chap-zen", start: "top center" },
        });
        ScrollTrigger.create({
          trigger: "#chap-letter",
          start: "top center",
          onEnter: typeWriter,
        });
      }

      // --- CANVAS: PETALS ---
      function initPetals() {
        const c = document.getElementById("canvas-petals");
        if (!c) return;
        const ctx = c.getContext("2d");
        c.width = window.innerWidth;
        c.height = window.innerHeight;
        // ... (Code c√°nh hoa gi·ªØ nguy√™n ho·∫∑c th√™m n·∫øu c·∫ßn)
      }

      // --- THREAD ---
      function initThread() {
        const c = document.getElementById("canvas-thread");
        const ctx = c.getContext("2d");
        c.width = window.innerWidth;
        c.height = window.innerHeight;
        let stars = Array.from({ length: 60 }, () => ({
          x: Math.random() * c.width,
          y: Math.random() * c.height,
          s: Math.random() * 2,
          a: Math.random(),
        }));
        function anim() {
          ctx.clearRect(0, 0, c.width, c.height);
          stars.forEach((s) => {
            ctx.fillStyle = `rgba(255,192,203,${s.a})`;
            ctx.beginPath();
            ctx.arc(s.x, s.y, s.s, 0, 6.28);
            ctx.fill();
            s.a = 0.5 + Math.sin(Date.now() * 0.001 + s.x) * 0.5;
          });
          ctx.strokeStyle = "rgba(255, 46, 99, 0.4)";
          ctx.lineWidth = 1;
          ctx.beginPath();
          ctx.moveTo(0, c.height / 2);
          ctx.bezierCurveTo(
            c.width / 3,
            c.height / 3,
            (c.width * 2) / 3,
            (c.height * 2) / 3,
            c.width,
            c.height / 2,
          );
          ctx.stroke();
          requestAnimationFrame(anim);
        }
        anim();
      }

      // --- TYPEWRITER ---
      const txt = `G·ª≠i Kim Ng·ªçc - N√†ng th∆° vƒ©nh c·ª≠u c·ªßa anh,<br><br>
        Ng∆∞·ªùi ta n√≥i v≈© tr·ª• bao la v√¥ t·∫≠n, nh∆∞ng anh kh√¥ng tin v√†o s·ª± v√¥ t·∫≠n ƒë√≥ cho ƒë·∫øn khi l·∫°c v√†o √°nh m·∫Øt em.<br><br>
        Ng√†y 10/1 l√† kh·ªüi ƒë·∫ßu c·ªßa ƒë·ªãnh m·ªánh, nh∆∞ng ng√†y 26/1 m·ªõi l√† kho·∫£nh kh·∫Øc linh h·ªìn anh th·ª±c s·ª± t√¨m th·∫•y b·∫øn ƒë·ªó. Gi·ªØa mu√¥n v√†n tinh t√∫, em l√† ng√¥i sao s√°ng nh·∫•t, ·∫•m √°p nh·∫•t soi r·ªçi cu·ªôc ƒë·ªùi anh.<br><br>
        C·∫£m ∆°n em - m·ªôt Tr·∫ßn Kim B·∫£o Ng·ªçc v·ªõi tr√°i tim thi·ªán l∆∞∆°ng v√† bao dung - ƒë√£ d≈©ng c·∫£m n·∫Øm l·∫•y tay anh khi anh ch∆∞a c√≥ g√¨ trong tay ngo√†i m·ªôt t·∫•m ch√¢n t√¨nh.<br><br>
        Anh kh√¥ng h·ª©a s·∫Ω cho em c·∫£ th·∫ø gi·ªõi ngay l·∫≠p t·ª©c, nh∆∞ng anh th·ªÅ s·∫Ω d√πng t·ª´ng gi√¢y ph√∫t c·ªßa cu·ªôc ƒë·ªùi n√†y ƒë·ªÉ ki·∫øn t·∫°o m·ªôt th·∫ø gi·ªõi m√† ·ªü ƒë√≥, em l√† N·ªØ Ho√†ng h·∫°nh ph√∫c nh·∫•t.<br><br>
        Tu·ªïi 18 r·ª±c r·ª° v√† b√¨nh an nh√©, V·ª£ y√™u c·ªßa anh!<br><b>VƒÉn Tr√≠.</b>`;
      let isTyped = false;
      function typeWriter() {
        if (isTyped) return;
        isTyped = true;
        document.getElementById("letter-content").innerHTML = txt;
        gsap.from("#letter-content", { opacity: 0, y: 20, duration: 2 });
      }

      // --- HOLD TO PRAY ---
      function initHold() {
        const target = document.getElementById("hold-target");
        const frame = document.querySelector(".prayer-frame");
        const img = document.getElementById("prayer-img");
        const content = document.getElementById("prayer-text");
        const hint = document.getElementById("hold-hint");
        const ring = document.querySelector(".energy-ring");
        let timer = null;
        let progress = 0;

        function start(e) {
          e.preventDefault();
          frame.style.transform = "scale(0.95)";
          ring.style.opacity = 1;
          timer = setInterval(() => {
            progress += 2;
            img.style.filter = `sepia(${0.2 + (progress / 100) * 0.8})`;
            frame.style.boxShadow = `0 0 ${progress / 2}px rgba(251, 197, 49, 0.6)`;
            if (progress >= 100) finish();
          }, 30);
        }
        function end() {
          clearInterval(timer);
          if (progress < 100) {
            progress = 0;
            frame.style.transform = "scale(1)";
            img.style.filter = "sepia(0.2)";
            ring.style.opacity = 0;
          }
        }
        function finish() {
          clearInterval(timer);
          confetti({
            particleCount: 200,
            spread: 100,
            origin: { y: 0.6 },
            colors: ["#fbc531", "#e84393"],
          });
          gsap.to(img, { filter: "brightness(0.3) blur(2px)", duration: 1 });
          gsap.to(hint, { opacity: 0 });
          gsap.to(ring, { scale: 1.5, opacity: 0, duration: 0.5 });
          gsap.to(content, {
            opacity: 1,
            scale: 1,
            duration: 1.5,
            ease: "power2.out",
          });
          target.removeEventListener("mousedown", start);
          target.removeEventListener("touchstart", start);
        }
        target.addEventListener("mousedown", start);
        target.addEventListener("mouseup", end);
        target.addEventListener("touchstart", start);
        target.addEventListener("touchend", end);
      }

      // --- SIGNATURE ---
      const cvs = document.getElementById("signature-pad");
      const cx = cvs.getContext("2d");
      let draw = false;
      function resize() {
        const rect = cvs.getBoundingClientRect();
        cvs.width = rect.width;
        cvs.height = rect.height;
        cx.strokeStyle = "#4a2c2c";
        cx.lineWidth = 2;
        cx.lineCap = "round";
      }
      setTimeout(resize, 500);
      function getPos(e) {
        const rect = cvs.getBoundingClientRect();
        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;
        return { x: clientX - rect.left, y: clientY - rect.top };
      }
      function dStart(e) {
        draw = true;
        const p = getPos(e);
        cx.beginPath();
        cx.moveTo(p.x, p.y);
      }
      function dMove(e) {
        if (!draw) return;
        e.preventDefault();
        const p = getPos(e);
        cx.lineTo(p.x, p.y);
        cx.stroke();
      }
      function dEnd() {
        draw = false;
      }
      cvs.addEventListener("mousedown", dStart);
      cvs.addEventListener("mousemove", dMove);
      cvs.addEventListener("mouseup", dEnd);
      cvs.addEventListener("touchstart", dStart, { passive: false });
      cvs.addEventListener("touchmove", dMove, { passive: false });
      cvs.addEventListener("touchend", dEnd);

      function submitSign() {
        const seal = document.getElementById("seal");
        gsap.to(seal, {
          opacity: 1,
          scale: 1,
          duration: 0.5,
          ease: "back.out(1.7)",
        });
        document.querySelector(".sign-btn").style.display = "none";
        confetti({
          particleCount: 400,
          spread: 180,
          origin: { y: 0.8 },
          colors: ["#ffd700", "#ffffff", "#ffb7c5"],
        });
        setTimeout(() => alert("Ng·ªçc ƒë√£ thu·ªôc v·ªÅ Tr√≠. Vƒ©nh vi·ªÖn!"), 1000);
      }

      // --- LOGIC CHO SECTION 2 (DUAL VIBE) ---
        function activeVibe(type) {
            const leftCard = document.querySelector('.s2-card.left');
            const rightCard = document.querySelector('.s2-card.right');
            const section = document.getElementById('chap-zen');
            const msg = document.getElementById('s2-msg');

            // Reset state
            msg.style.opacity = 0;
            
            if(type === 'pink') {
                // Hi·ªáu ·ª©ng PINK
                leftCard.classList.add('active'); leftCard.classList.remove('inactive');
                rightCard.classList.add('inactive'); rightCard.classList.remove('active');
                
                // ƒê·ªïi n·ªÅn sang h·ªìng ƒë·∫≠m h∆°n ch√∫t
                section.style.background = "linear-gradient(135deg, #ffc3a0 0%, #ffafbd 100%)";
                
                // B·∫Øn Confetti H·ªìng & K·∫πo ng·ªçt
                confetti({
                    particleCount: 100, spread: 70, origin: { x: 0.3, y: 0.5 },
                    colors: ['#ff9a9e', '#fecfef', '#ffffff'],
                    shapes: ['circle']
                });

                // ƒê·ªïi l·ªùi nh·∫Øn
                setTimeout(() => {
                    msg.innerHTML = "Em l√† vi√™n k·∫πo ng·ªçt ng√†o nh·∫•t th·∫ø gian ‚ù§";
                    msg.style.color = "#c0392b";
                    msg.style.opacity = 1; msg.style.transform = "translateY(0)";
                }, 300);

            } else {
                // Hi·ªáu ·ª©ng WHITE
                rightCard.classList.add('active'); rightCard.classList.remove('inactive');
                leftCard.classList.add('inactive'); leftCard.classList.remove('active');
                
                // ƒê·ªïi n·ªÅn sang Tr·∫Øng xanh tinh kh√¥i
                section.style.background = "linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%)";
                
                // B·∫Øn Confetti Sao & L·∫•p l√°nh
                confetti({
                    particleCount: 100, spread: 70, origin: { x: 0.7, y: 0.5 },
                    colors: ['#a18cd1', '#fbc2eb', '#ffffff'],
                    shapes: ['star']
                });

                // ƒê·ªïi l·ªùi nh·∫Øn
                setTimeout(() => {
                    msg.innerHTML = "V√† l√† thi√™n th·∫ßn trong tr·∫ªo nh·∫•t c·ªßa anh ‚ú®";
                    msg.style.color = "#2c3e50";
                    msg.style.opacity = 1; msg.style.transform = "translateY(0)";
                }, 300);
            }
        }
        
        // Animation xu·∫•t hi·ªán ban ƒë·∫ßu
        gsap.to(".s2-card", {
            y: 0, opacity: 1, duration: 1, stagger: 0.2, ease: "back.out(1.7)",
            scrollTrigger: { trigger: "#chap-zen", start: "top center" }
        });
    </script>
  </body>
</html>
